{"version":3,"sources":["tracker.js"],"names":["jQuery","document","ready","$","makeUrl","url","replace","each","index","player","$player","this","$tracker","find","length","played","episodeId","attr","href","bind","e","window","capitalP","resetPostData","ga","hitType","page","split","location","err","data","eventCategory","prop","eventAction","eventLabel","eventValue","i","eventType","event","on","blank","path","hitCallback","preventDefault","console","log"],"mappings":"AAOAA,OAAOC,UAAUC,MAAM,SAAUC,GAE/B,YAEA,SAASC,GAAQC,GACf,MAAOA,GAAIC,QAAQ,qBAAsB,IAI3CH,EAAE,mBAAmBI,KAAK,SAASC,EAAOC,GAExC,GAAIC,GAAUP,EAAEQ,MACZC,EAAWF,EAAQG,KAAK,0BAC5B,KAAMD,EAASE,OACb,OAAO,CAGT,IAAIC,IAAS,EAETC,EAAYJ,EAASK,KAAK,mBAG1BC,GAFgBN,EAASK,KAAK,uBAChBL,EAASK,KAAK,qBACrBb,EAASQ,EAASK,KAAK,aAElCP,GAAQG,KAAK,eAAeM,KAAK,OAAQ,SAASC,GAEhD,IAAKL,EAAQ,CACXA,GAAS,CACT,KACEM,OAAOC,SAASC,gBAChBC,GAAG,QACDC,QAAS,WACTC,KAAMR,EAAKS,MAAM,KAAK,GACtBC,SAAUV,IAEb,MAAOW,KAEV,IACE,GAAIC,IACFL,QAAe,QACfM,cAAe5B,EAAEQ,MAAMqB,KAAK,WAC5BC,YAAe,OACfC,WAAelB,EACfmB,WAAe,EAEjBX,IAAG,OAAQM,GACX,MAAOD,OAGX1B,EAAEI,MAAM,QAAS,QAAS,QAAS,SAAU,SAAS6B,EAAGC,GACvD3B,EAAQG,KAAK,eAAeM,KAAKkB,EAAW,SAASC,GACnD,IACE,GAAIR,IACFL,QAAe,QACfM,cAAe5B,EAAEQ,MAAMqB,KAAK,WAC5BC,YAAeI,EACfH,WAAelB,EACfmB,WAAe,EAEjBX,IAAG,OAAQM,GACX,MAAOD,WAMf1B,EAAE,iBAAiBoC,GAAI,QAAS,IAAK,SAASnB,GAC5C,GACIoB,IADQrC,EAAEQ,MAAMM,KAAK,SACb,UAAYd,EAAEQ,MAAMM,KAAK,WACjCC,EAAQf,EAAEQ,MAAMM,KAAK,OACzB,KACE,GAAIwB,GAAOrC,EAAQc,GACfoB,GACFb,QAAS,WACTC,KAAMe,EAAKd,MAAM,KAAK,GACtBC,SAAUa,EACVC,YAAa,WACPF,IACFnB,OAAOO,SAASV,KAAOA,IAI7BG,QAAOC,SAASC,gBAChBC,GAAG,OAAQc,GACNE,GACHpB,EAAEuB,iBAEL,MAAMd,GACAR,OAAOuB,SACVvB,OAAOuB,QAAQC,IAAIhB","file":"../tracker.js","sourcesContent":["/**\n * Description\n */\n\n/*global ga:false */\n/*global capitalP:false */\n\njQuery(document).ready(function ($) {\n\n  \"use strict\";\n\n  function makeUrl(url){\n    return url.replace(/^https?:\\/\\/[^\\/]+/, '');\n  }\n\n  // Track pod cast events\n  $('.podcast_player').each(function(index, player){\n    // Check if tracker exists.\n    var $player = $(this);\n    var $tracker = $player.find('.capitalp-media-tracker');\n    if ( !$tracker.length ) {\n      return true;\n    }\n    // Add event listeners\n    var played = false;\n    var playCount = 0;\n    var episodeId = $tracker.attr('data-episode-id');\n    var episodeAuthor = $tracker.attr('data-episode-author');\n    var episodeTags = $tracker.attr('data-episode-tags');\n    var href = makeUrl( $tracker.attr('data-src') );\n    // Save play count\n    $player.find('audio,video').bind('play', function(e){\n      // First play\n      if (!played) {\n        played = true;\n        try{\n          window.capitalP.resetPostData();\n          ga('send', {\n            hitType: 'pageview',\n            page: href.split('?')[0],\n            location: href\n          });\n        }catch (err){}\n      }\n      try {\n        var data = {\n          hitType      : 'event',\n          eventCategory: $(this).prop('tagName'),\n          eventAction  : 'play',\n          eventLabel   : episodeId,\n          eventValue   : 1\n        };\n        ga('send', data);\n      } catch (err) {}\n    });\n    // Save other event\n    $.each(['ended', 'pause', 'error', 'abort'], function(i, eventType){\n      $player.find('audio,video').bind(eventType, function(event){\n        try {\n          var data = {\n            hitType      : 'event',\n            eventCategory: $(this).prop('tagName'),\n            eventAction  : eventType,\n            eventLabel   : episodeId,\n            eventValue   : 1\n          };\n          ga('send', data);\n        } catch (err) {}\n      });\n    });\n  });\n\n  // Track download event\n  $('.podcast_meta').on( 'click', 'a', function(e){\n    var title = $(this).attr('title');\n    var blank = '_blank' == $(this).attr('target');\n    var href  = $(this).attr('href');\n    try{\n      var path = makeUrl(href);\n      var event = {\n        hitType: 'pageview',\n        page: path.split('?')[0],\n        location: path,\n        hitCallback: function(){\n          if (blank) {\n            window.location.href = href;\n          }\n        }\n      };\n      window.capitalP.resetPostData();\n      ga('send', event);\n      if ( blank ) {\n        e.preventDefault();\n      }\n    }catch(err){\n      if ( window.console ) {\n        window.console.log(err);\n      }\n    }\n  });\n});\n"]}